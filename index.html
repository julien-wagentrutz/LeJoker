<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="public/styles/main.css">
</head>
<body>
    <div id="scene">
        <ul id="jokerBackground">
            <li><img src="public/images/backgroundLight.jpg" alt=""></li>
            <li><img id="jokerBackgroundDark" src="public/images/backgroundDark.png" alt=""></li>
        </ul>
        <ul id="jokerFace">
            <li><img src="public/images/asset1.svg" alt="" ></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset2.svg" alt="" class="hidden"></li>
            <li><img src="public/images/asset1.svg" alt="" class="hidden"></li>
        </ul>
        <a class="btn discovery" href="#">DÃ©couvrir le site</a>
    </div>
</body>
    <script>
        let scroll = 0
        let scale = 1
        let etape = 0
        let pictures = document.querySelectorAll('#scene #jokerFace li')
        let percentScale = 0.15
        let speed = 0.3
        let opacity = 0
        let audioStart = new Audio('public/sound/start.mp3');
        let audioEnd = new Audio('public/sound/end.mp3');
        let audioBox = [new Audio('public/sound/Jokerlaugh1.mp3')
            ,new Audio('public/sound/Jokerlaugh2.mp3')
            ,new Audio('public/sound/slap1.mp3')
            ,new Audio('public/sound/slap2.mp3')
            ,new Audio('public/sound/slap3.mp3')
            ,new Audio('public/sound/gun.mp3')
            ,new Audio('public/sound/crowd.mp3')
        ]

        audioStart.volume = 0.1
        audioEnd.volume = 0.1

        window.addEventListener('keypress',function () {
            let randomNum = Math.floor(Math.random()*audioBox.length)
            audioBox[randomNum].volume = 1
            if(randomNum>1)
            {
                audioBox[randomNum].volume = 0.5
            }
            audioBox[randomNum].play()
            console.log(randomNum)

        })

        window.onload = function () {
            audioStart.play()
            audioEnd.pause()
        }

        if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
            percentScale = 0.05
            speed = 0.1
        }

        window.addEventListener('touchmove', function (e) {
            play(e.touches[0].pageY)
        })


        window.addEventListener('wheel', function (e) {
            play(e.deltaY)
        })
        
        function play(deltaY) {

            if(deltaY > 0){
                scroll += deltaY* speed
                if(scroll > (pictures.length-1)*100)
                {
                    scroll =  (pictures.length-1 )*100
                }

            }
            else
            {
                scroll += deltaY * speed
                if(scroll< 0)
                {
                    scroll = 0;
                }

            }




            pictures[etape].querySelector('img').classList.add('hidden')
            if((etape == 10) && 10 > Math.round(scroll/100))
            {
                audioStart.play()
                audioEnd.pause()
            }
            else if((etape == 10) && 10 < Math.round(scroll/100))
            {
                audioStart.pause()
                audioEnd.play()
            }


            etape = Math.round(scroll/100)
            if(etape >= pictures.length)
            {
                etape = pictures.length-1
            }
            pictures[etape].querySelector('img').classList.remove('hidden')

            for(let i = 0; i < pictures.length;i++)
            {
                pictures[i].querySelector('img').style.transform = 'scale('+scale+')'
            }


            document.querySelector('#jokerBackgroundDark').style.opacity = 0.05 * etape


            console.log(etape)
            scale = etape * percentScale + 1
            pictures[etape].querySelector('img').style.transform = 'scale('+scale+')'



        }
    </script>
</html>